# gossip-appimage

This Nix flake can be used to build an AppImage of the [Gossip](https://github.com/mikedilger/gossip) Nostr client. It is designed such that even if you've never used the [Nix](https://nixos.org/) package manager before, you should be able to easily complete the instructions.

## Ingredients

1. The Nix package manager, with Nix flakes enabled.

The Nix can run on most Linux distributions. For the purposes of using this Nix flake, you can go with the portable version of Nix by downloading [nix-portable](https://github.com/DavHau/nix-portable). 

## Recipe

1. Install the Nix package manager and enable Nix flakes. For this recipe I'll asume you're unfamiliar with Nix. Therefore, simply head to https://github.com/DavHau/nix-portable and download the latest release.
2. Make `nix-portable` executable: Ex. `chmod u+x ./nix-portable`
3. Using a terminal, run `./nix-portable nix-shell -p nix bash`
4. Now you're in a Bash shell with Nix available. To build the AppImage, run `nix build github:emmanuelrosa/gossip-appimage#gossip-appimage`
5. The build process will create a symlink named `result` pointing to the AppImage in the Nix store. You'll need to copy the AppImage out of the Nix store. Run `cp ./result ./Gossip.AppImage`
6. Now, exit `nix-portable` by executing `exit`
7. Make the AppImage executable. Ex. `chmod u+x Gossip.AppImage`

Now you can execute the `Gossip.AppImage`!

## How does it work?

The AppImage is generated by first taking the Gossip dep package and building a Nix package out of it. The package is located in my Nix flake https://github.com/emmanuelrosa/erosanix/tree/master/pkgs/gossip

Next, this Nix flake takes the aforementioned Gossip Nix package and wrapps it in a script sets LD_LIBRARY_PATH so that Gossip is able to find its dependencies. The AppImage is designed to contain *all* of Gossip's dependencies; All the way down to libc. With the exception of the OpenGL libraries, since those are hardware-dependent.

Finally, [nix-appimage](https://github.com/ralismark/nix-appimage) is used to build an AppImage using the wrapped Gossip Nix package.
